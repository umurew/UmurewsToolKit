<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="TaskManager.Pages.ProcessesPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TaskManager"
    xmlns:classes="using:TaskManager.Classes"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:diagnostics="using:System.Diagnostics"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance Type=classes:ProcessItemViewModel}">

    <Page.Resources>
        <classes:BytesToMBConverter x:Key="BytesToMBConverter"/>
    </Page.Resources>

    <Grid Padding="36">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Margin="0,4,0,36" Text="Processes" Style="{StaticResource TitleTextBlockStyle}"/>

        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0"
                  Padding="16, 12">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition x:Name="Column0" Width="4*"/>
                    <ColumnDefinition x:Name="Column1" Width="*"/>
                    <ColumnDefinition x:Name="Column2" Width="*"/>
                    <ColumnDefinition x:Name="Column3" Width="*"/>
                    <ColumnDefinition x:Name="Column4" Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" x:Name="NameColumn" Text="Name" Style="{StaticResource BodyLargeStrongTextBlockStyle}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                <TextBlock Grid.Column="1" x:Name="PIDColumn" Text="PID" Style="{StaticResource BodyLargeStrongTextBlockStyle}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                <TextBlock Grid.Column="2" x:Name="StatusColumn" Text="Status" Style="{StaticResource BodyLargeStrongTextBlockStyle}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                <TextBlock Grid.Column="3" x:Name="CPUColumn" Text="CPU" Style="{StaticResource BodyLargeStrongTextBlockStyle}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                <TextBlock Grid.Column="4" x:Name="MemoryColumn" Text="Memory" Style="{StaticResource BodyLargeStrongTextBlockStyle}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
            </Grid>

            <ListView Grid.Row="1"
                      x:Name="ProcessListView"
                      ItemsSource="{x:Bind Processes}"
                      SelectionMode="Single"
                      IsItemClickEnabled="True"
                      Padding="0">

                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Setter Property="Padding" Value="16,12"/>
                        <Setter Property="MinHeight" Value="48"/>
                        <Setter Property="ContextFlyout">
                            <Setter.Value>
                                <MenuFlyout>
                                    <MenuFlyoutItem Text="Expand" Tag="Expand" Click="MenuFlyout_Click">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xE70D;" />
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutItem Text="End task" Tag="EndTask" Click="MenuFlyout_Click">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xE711;" />
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutSeparator/>
                                    <MenuFlyoutItem Text="Open file location" Tag="OpenFileLocation"  Click="MenuFlyout_Click">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xE8DA;" />
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutItem Text="Properties" Tag="Properties"  Click="MenuFlyout_Click">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon Glyph="&#xE8E5;" />
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                </MenuFlyout>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListView.ItemContainerStyle>

                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="classes:ProcessItemViewModel">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=Column0, Path=Width}"/>
                                <ColumnDefinition Width="{Binding ElementName=Column1, Path=Width}"/>
                                <ColumnDefinition Width="{Binding ElementName=Column2, Path=Width}"/>
                                <ColumnDefinition Width="{Binding ElementName=Column3, Path=Width}"/>
                                <ColumnDefinition Width="{Binding ElementName=Column4, Path=Width}"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="{Binding ElementName=NameColumn, Path=(Grid.Column)}"
                                       Text="{x:Bind DisplayName, Mode=OneWay}"
                                       Style="{StaticResource BodyTextBlockStyle}"
                                       VerticalAlignment="Center"
                                       TextTrimming="CharacterEllipsis"/>
                            <TextBlock Grid.Column="{Binding ElementName=PIDColumn, Path=(Grid.Column)}"
                                       Text="{x:Bind ProcessId, Mode=OneWay}"
                                       Style="{StaticResource BodyTextBlockStyle}"
                                       VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="{Binding ElementName=StatusColumn, Path=(Grid.Column)}"
                                       Text="{x:Bind Status, Mode=OneWay}"
                                       Style="{StaticResource BodyTextBlockStyle}"
                                       VerticalAlignment="Center"
                                       Foreground="{ThemeResource SystemAccentColor}"/>
                            <TextBlock Grid.Column="{Binding ElementName=CPUColumn, Path=(Grid.Column)}"
                                       Text="{x:Bind CPUUsage, Mode=OneWay}"
                                       Style="{StaticResource BodyTextBlockStyle}"
                                       Foreground="{x:Bind CPUColor, Mode=OneWay}"
                                       VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="{Binding ElementName=MemoryColumn, Path=(Grid.Column)}"
                                       Text="{x:Bind MemoryUsage, Mode=OneWay}"
                                       Style="{StaticResource BodyTextBlockStyle}"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>
    </Grid>
</Page>